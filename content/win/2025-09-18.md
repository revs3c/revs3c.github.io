---
layout: default
title:  "Windows Enum"
weight: 2
type: docs
---

## Windows User Enum

#### To retrive every known user 
```
Get-ADUser -Filter *
```  

#### This will search for every user present in OU THM     
```
Get-ADUser -Filter * -SearchBase "OU=THM,DC=thmredteam,DC=com"
```
    
    
## Detecting AV's

#### To detect 3rd party AV's
  
```  
Get-CimInstance -Namespace root/SecurityCenter2 -ClassName AntivirusProduct
```


#### To get info for Windows Defender   
    
```
Get-Service WinDefend
```
- Retrieves the status of the Windows Defender Antivirus service (WinDefend), which provides real-time protection against malware on Windows systems.
- Returns a ServiceController object with:

	- Status: Running, Stopped, Starting (use Status property).

	- Name: "WinDefend".

	- DisplayName: "Microsoft Defender Antivirus Service".

	- DependentServices: Lists services it supports (e.g., Sense)

#### Status of WinDefender
```
Get-MpComputerStatus
```
- Returns a single object with 30+ properties about Defender's state:

	- Protection status: AntivirusEnabled, RealTimeProtectionEnabled, AntispywareEnabled (True/False).

	- Signatures: AntivirusSignatureVersion, AntispywareSignatureLastUpdated, SignatureAge (days).

	- Scan info: FullScanEndTime, QuickScanAge, RealTimeScanDirection.

	- Engine: AMEngineVersion, AMServiceEnabled, ComputerState (e.g., "Normal").
​
## Firewall Detection

Retrieves and displays the enabled status of Windows Firewall's three network profiles (Domain, Private, Public) in a clean table format

```
Get-NetFirewallProfile | Format-Table Name, Enabled
```

#### Disabling Firewall

Disables Windows Firewall across all three profiles (Domain, Private, Public) on the local machine. {Applies immediately (no reboot).}
​

```
Set-NetFirewallProfile -Profile Domain, Public, Private -Enabled False
```
    
#### Checking Firewall Rule's.

Lists all Windows Firewall rules with their name, enabled status, and description in a custom table.

```    
Get-NetFirewallRule | select DisplayName, Enabled, Description
```

#### Testing Inbound Connection

Tests TCP connectivity to localhost (127.0.0.1) on port 80 (HTTP), simulating if a web server is reachable locally

```
Test-NetConnection -ComputerName 127.0.0.1 -Port 80
```

## SYSMON

The sysmon tool starts gathering and logging events once installed. One of the great features of the sysmon  tool is that it can log many important events, and you can also create your own rule(s) and configuration to monitor.

   - Process creation and termination	
   - Network connections
   - Modification on file
   - Remote threats.
   - Process and memory access
   
#### Detecting SYSMON
   
Look's for a process or service that has been named "Sysmon" within the current process or services.
   
```	
Get-Process | Where-Object { $_.ProcessName -eq "Sysmon" }
```
 
#### Checking the Windows registry for sysmon 
 
```   
reg query HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\WINEVT\Channels\Microsoft-Windows-Sysmon/Operational
```   
## Hidden Item's
   
#### Looking for hidden files or backups.
    
```
Get-ChildItem -Hidden -Path C:\Users\kkidd\Desktop\
```    

#### List's installed packages on the system
 
```   
Get-CimInstance -ClassName Win32_Product/Get-Package
```
   
## Getting Groups & Members

```
net localgroup
net group
```

- Lists all local groups and their members on the current Windows machine for **localgroup**
- Lists all groups and their members on the current Windows AD machine for **domain group**

You can list the users that belong to the local administrators.

```
net localgroup administrators
```

Used to see the local settings on a machine.

```    
net accounts
```    
 
You can use if the machine belongs to a domain, command helps learn about **password policy**, such as minimum password length, maximum password age, and lockout duration.
    
 
```
net accounts /domain
```

    
    
    
    
Linux Enum

ls /etc/*-release
    we can get more information about the Linux distribution and release version by searching for files or links that end with release
    
hostname 
    We can find the system’s name
    
**Any user can read the files passwd and group. However, the shadow password file requires root privileges**

ls -lh /usr/bin/
ls -lh /sbin/
dpkg -l
    To find the installed applications
rpm -qa 
    The -qa indicates that we want to query all packages
    
w
    which shows who is logged in and what they are doing
    
last 
    displays a listing of the last logged-in users, we can see who logged out and how much they stayed connected
    
sudo -l
    lists the allowed command for the invoking user on the current system
    
/etc/resolv.conf
    DNS servers can be found 
    
lsof --> stands for List Open Files
    If we want to display only Internet and network connections, we can use lsof -i. The terminal output below shows IPv4 and IPv6 listening services and ongoing connections
    
ps 
    a snapshot of the running processes can provide many insights

